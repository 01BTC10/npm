var cov_2o993g32ll=function(){var path='/Users/zkat/Documents/code/npm/lib/config/find-prefix.js',hash='8a17176a930fead9eba17f989828c9232e624431',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/zkat/Documents/code/npm/lib/config/find-prefix.js',statementMap:{'0':{start:{line:3,column:0},end:{line:3,column:27}},'1':{start:{line:5,column:9},end:{line:5,column:22}},'2':{start:{line:6,column:11},end:{line:6,column:26}},'3':{start:{line:10,column:4},end:{line:12,column:6}},'4':{start:{line:11,column:6},end:{line:11,column:16}},'5':{start:{line:15,column:2},end:{line:15,column:21}},'6':{start:{line:19,column:17},end:{line:19,column:22}},'7':{start:{line:20,column:2},end:{line:23,column:3}},'8':{start:{line:21,column:4},end:{line:21,column:23}},'9':{start:{line:22,column:4},end:{line:22,column:19}},'10':{start:{line:24,column:2},end:{line:24,column:34}},'11':{start:{line:24,column:16},end:{line:24,column:34}},'12':{start:{line:26,column:2},end:{line:26,column:23}},'13':{start:{line:30,column:2},end:{line:33,column:3}},'14':{start:{line:32,column:4},end:{line:32,column:29}},'15':{start:{line:34,column:2},end:{line:55,column:4}},'16':{start:{line:38,column:4},end:{line:41,column:5}},'17':{start:{line:39,column:6},end:{line:39,column:57}},'18':{start:{line:39,column:32},end:{line:39,column:57}},'19':{start:{line:40,column:6},end:{line:40,column:19}},'20':{start:{line:44,column:4},end:{line:44,column:37}},'21':{start:{line:44,column:12},end:{line:44,column:37}},'22':{start:{line:46,column:4},end:{line:49,column:5}},'23':{start:{line:48,column:6},end:{line:48,column:24}},'24':{start:{line:51,column:12},end:{line:51,column:27}},'25':{start:{line:52,column:4},end:{line:52,column:42}},'26':{start:{line:52,column:17},end:{line:52,column:42}},'27':{start:{line:54,column:4},end:{line:54,column:39}}},fnMap:{'0':{name:'findPrefix',decl:{start:{line:8,column:9},end:{line:8,column:19}},loc:{start:{line:8,column:29},end:{line:27,column:1}},line:8},'1':{name:'cb',decl:{start:{line:9,column:11},end:{line:9,column:13}},loc:{start:{line:9,column:22},end:{line:13,column:3}},line:9},'2':{name:'(anonymous_2)',decl:{start:{line:10,column:21},end:{line:10,column:22}},loc:{start:{line:10,column:33},end:{line:12,column:5}},line:10},'3':{name:'findPrefix_',decl:{start:{line:29,column:9},end:{line:29,column:20}},loc:{start:{line:29,column:39},end:{line:56,column:1}},line:29},'4':{name:'(anonymous_4)',decl:{start:{line:34,column:16},end:{line:34,column:17}},loc:{start:{line:34,column:37},end:{line:55,column:3}},line:34}},branchMap:{'0':{loc:{start:{line:24,column:2},end:{line:24,column:34}},type:'if',locations:[{start:{line:24,column:2},end:{line:24,column:34}},{start:{line:24,column:2},end:{line:24,column:34}}],line:24},'1':{loc:{start:{line:30,column:2},end:{line:33,column:3}},type:'if',locations:[{start:{line:30,column:2},end:{line:33,column:3}},{start:{line:30,column:2},end:{line:33,column:3}}],line:30},'2':{loc:{start:{line:30,column:6},end:{line:31,column:70}},type:'binary-expr',locations:[{start:{line:30,column:6},end:{line:30,column:15}},{start:{line:31,column:7},end:{line:31,column:35}},{start:{line:31,column:39},end:{line:31,column:69}}],line:30},'3':{loc:{start:{line:38,column:4},end:{line:41,column:5}},type:'if',locations:[{start:{line:38,column:4},end:{line:41,column:5}},{start:{line:38,column:4},end:{line:41,column:5}}],line:38},'4':{loc:{start:{line:38,column:8},end:{line:38,column:28}},type:'binary-expr',locations:[{start:{line:38,column:8},end:{line:38,column:10}},{start:{line:38,column:14},end:{line:38,column:28}}],line:38},'5':{loc:{start:{line:39,column:6},end:{line:39,column:57}},type:'if',locations:[{start:{line:39,column:6},end:{line:39,column:57}},{start:{line:39,column:6},end:{line:39,column:57}}],line:39},'6':{loc:{start:{line:44,column:4},end:{line:44,column:37}},type:'if',locations:[{start:{line:44,column:4},end:{line:44,column:37}},{start:{line:44,column:4},end:{line:44,column:37}}],line:44},'7':{loc:{start:{line:46,column:4},end:{line:49,column:5}},type:'if',locations:[{start:{line:46,column:4},end:{line:49,column:5}},{start:{line:46,column:4},end:{line:49,column:5}}],line:46},'8':{loc:{start:{line:46,column:8},end:{line:47,column:44}},type:'binary-expr',locations:[{start:{line:46,column:8},end:{line:46,column:44}},{start:{line:47,column:8},end:{line:47,column:44}}],line:46},'9':{loc:{start:{line:52,column:4},end:{line:52,column:42}},type:'if',locations:[{start:{line:52,column:4},end:{line:52,column:42}},{start:{line:52,column:4},end:{line:52,column:42}}],line:52}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0},b:{'0':[0,0],'1':[0,0],'2':[0,0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();++cov_2o993g32ll.s[0];// try to find the most reasonable prefix to use
module.exports=findPrefix;var fs=(++cov_2o993g32ll.s[1],require('fs'));var path=(++cov_2o993g32ll.s[2],require('path'));function findPrefix(p,cb_){++cov_2o993g32ll.f[0];function cb(er,p){++cov_2o993g32ll.f[1];++cov_2o993g32ll.s[3];process.nextTick(function(){++cov_2o993g32ll.f[2];++cov_2o993g32ll.s[4];cb_(er,p);});}++cov_2o993g32ll.s[5];p=path.resolve(p);// if there's no node_modules folder, then
// walk up until we hopefully find one.
// if none anywhere, then use cwd.
var walkedUp=(++cov_2o993g32ll.s[6],false);++cov_2o993g32ll.s[7];while(path.basename(p)==='node_modules'){++cov_2o993g32ll.s[8];p=path.dirname(p);++cov_2o993g32ll.s[9];walkedUp=true;}++cov_2o993g32ll.s[10];if(walkedUp){++cov_2o993g32ll.b[0][0];++cov_2o993g32ll.s[11];return cb(null,p);}else{++cov_2o993g32ll.b[0][1];}++cov_2o993g32ll.s[12];findPrefix_(p,p,cb);}function findPrefix_(p,original,cb){++cov_2o993g32ll.f[3];++cov_2o993g32ll.s[13];if((++cov_2o993g32ll.b[2][0],p==='/')||(++cov_2o993g32ll.b[2][1],process.platform==='win32')&&(++cov_2o993g32ll.b[2][2],p.match(/^[a-zA-Z]:(\\|\/)?$/))){++cov_2o993g32ll.b[1][0];++cov_2o993g32ll.s[14];return cb(null,original);}else{++cov_2o993g32ll.b[1][1];}++cov_2o993g32ll.s[15];fs.readdir(p,function(er,files){++cov_2o993g32ll.f[4];++cov_2o993g32ll.s[16];// an error right away is a bad sign.
// unless the prefix was simply a non
// existent directory.
if((++cov_2o993g32ll.b[4][0],er)&&(++cov_2o993g32ll.b[4][1],p===original)){++cov_2o993g32ll.b[3][0];++cov_2o993g32ll.s[17];if(er.code==='ENOENT'){++cov_2o993g32ll.b[5][0];++cov_2o993g32ll.s[18];return cb(null,original);}else{++cov_2o993g32ll.b[5][1];}++cov_2o993g32ll.s[19];return cb(er);}else{++cov_2o993g32ll.b[3][1];}// walked up too high or something.
++cov_2o993g32ll.s[20];if(er){++cov_2o993g32ll.b[6][0];++cov_2o993g32ll.s[21];return cb(null,original);}else{++cov_2o993g32ll.b[6][1];}++cov_2o993g32ll.s[22];if((++cov_2o993g32ll.b[8][0],files.indexOf('node_modules')!==-1)||(++cov_2o993g32ll.b[8][1],files.indexOf('package.json')!==-1)){++cov_2o993g32ll.b[7][0];++cov_2o993g32ll.s[23];return cb(null,p);}else{++cov_2o993g32ll.b[7][1];}var d=(++cov_2o993g32ll.s[24],path.dirname(p));++cov_2o993g32ll.s[25];if(d===p){++cov_2o993g32ll.b[9][0];++cov_2o993g32ll.s[26];return cb(null,original);}else{++cov_2o993g32ll.b[9][1];}++cov_2o993g32ll.s[27];return findPrefix_(d,original,cb);});}